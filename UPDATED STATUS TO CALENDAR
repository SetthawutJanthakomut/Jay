// ===== CONFIG: Calendar ID =====
const CALENDAR_ID = "developeritd75@gmail.com";
const SURVEY_WORK_CALENDAR = "8ef1934c9a71220a0f47c1d5227bb6ca26b8bed6d5e54c568036b54117f51620@group.calendar.google.com";
const SURVEY_WORK_CENTRAL_CALENDAR = "6cbf6620e2630d70b763e8fe7f04d40b59d13da14a4c39cbb17687c69778b135@group.calendar.google.com";

// ===== STATUS OPTIONS =====
const STATUS_OPTIONS = {
  COMPLETED: "Inspection Completed",
  IN_PROGRESS: "In Progress",
  PENDING: "Pending Review",
  ON_HOLD: "On Hold",
  CANCELLED: "Cancelled",
  RESCHEDULED: "Rescheduled",
  APPROVED: "Approved",
  REJECTED: "Rejected"
};

// ====== UPDATE SURVEY STATUS (DYNAMIC) ======

function updateSurveyStatus(
  uniqueId,
  status = STATUS_OPTIONS.COMPLETED,
  description = '',
  statusNote = '',
  searchDays = 60
) {
  Logger.log(`âœ… Starting Survey status update for: ${uniqueId} â†’ Status: ${status}`);
  
  if (!uniqueId || uniqueId.trim() === '') {
    return {
      success: false,
      error: 'Unique ID is required',
      uniqueId: uniqueId,
      eventsFound: 0,
      eventsUpdated: 0
    };
  }

  if (!status || status.trim() === '') {
    return {
      success: false,
      error: 'Status is required',
      uniqueId: uniqueId,
      eventsFound: 0,
      eventsUpdated: 0
    };
  }

  const cleanUniqueId = uniqueId.trim();
  const cleanDescription = description ? description.trim() : '';
  const cleanStatus = status.trim();
  
  let result = {
    success: false,
    uniqueId: cleanUniqueId,
    status: cleanStatus,
    surveyDescription: cleanDescription,
    surveyEventsFound: 0,
    surveyEventsUpdated: 0,
    updatedSurveyEvents: [],
    error: null,
    message: ''
  };

  try {
    Logger.log("ğŸ” Step 1: Searching Calendar Events...");
    const surveySearchResult = searchCalendarEventsByUniqueId(cleanUniqueId, cleanDescription, CALENDAR_ID, searchDays);
    
    if (surveySearchResult.success && surveySearchResult.events.length > 0) {
      result.surveyEventsFound = surveySearchResult.events.length;
      Logger.log(`âœ… Found ${result.surveyEventsFound} calendar events`);
    } else {
      result.error = `No calendar events found for Survey: ${cleanUniqueId} / ${cleanDescription}`;
      result.message = result.error;
      Logger.log(`âš ï¸ ${result.error}`);
      return result;
    }

    Logger.log(`ğŸ“ Step 2: Updating Calendar Events to '${cleanStatus}'...`);
    
    for (let i = 0; i < surveySearchResult.events.length; i++) {
      const eventInfo = surveySearchResult.events[i];
      
      try {
        const updateSuccess = updateEventStatus(eventInfo, CALENDAR_ID, cleanStatus, statusNote);
        
        if (updateSuccess.success) {
          result.surveyEventsUpdated++;
          result.updatedSurveyEvents.push({
            eventId: eventInfo.eventId,
            title: eventInfo.title,
            originalTitle: eventInfo.title,
            updatedTitle: updateSuccess.updatedTitle,
            status: cleanStatus,
            calendarType: 'Survey'
          });
          Logger.log(`âœ… Event updated: "${eventInfo.title}" â†’ "${updateSuccess.updatedTitle}"`);
        }
        
      } catch (updateError) {
        Logger.log(`âŒ Error updating event: ${updateError.toString()}`);
      }
    }

    result.success = result.surveyEventsUpdated > 0;
    
    if (result.success) {
      result.message = `à¸­à¸±à¸›à¹€à¸”à¸• Survey ${cleanUniqueId} à¸ªà¸³à¹€à¸£à¹‡à¸ˆ: à¹à¸à¹‰à¹„à¸‚ ${result.surveyEventsUpdated} à¸£à¸²à¸¢à¸à¸²à¸£à¹€à¸›à¹‡à¸™ "${cleanStatus}"`;
    } else {
      result.message = `à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸­à¸±à¸›à¹€à¸”à¸• Survey ${cleanUniqueId} à¹„à¸”à¹‰`;
    }

  } catch (error) {
    result.error = error.toString();
    result.message = `à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¸­à¸±à¸›à¹€à¸”à¸• Survey ${cleanUniqueId}: ${result.error}`;
    Logger.log(`âŒ Unexpected error: ${result.error}`);
  }

  Logger.log("\n" + "=".repeat(50));
  Logger.log("âœ… à¸ªà¸£à¸¸à¸›à¸à¸²à¸£à¸­à¸±à¸›à¹€à¸”à¸• Survey:");
  Logger.log(`ğŸ†” Unique ID: ${result.uniqueId}`);
  Logger.log(`ğŸ“Š Status: ${result.status}`);
  Logger.log(`ğŸ“ à¸­à¸±à¸›à¹€à¸”à¸•à¹à¸¥à¹‰à¸§: ${result.surveyEventsUpdated}/${result.surveyEventsFound}`);
  Logger.log(`âœ… à¸ªà¸³à¹€à¸£à¹‡à¸ˆ: ${result.success ? 'à¹ƒà¸Šà¹ˆ' : 'à¹„à¸¡à¹ˆ'}`);

  return result;
}

// ====== UPDATE EVENT STATUS (DYNAMIC) ======

function updateEventStatus(eventInfo, calendarId, status, statusNote = '') {
  Logger.log(`ğŸ“ Attempting to update event: ${eventInfo.title} â†’ ${status}`);
  
  try {
    const calendar = CalendarApp.getCalendarById(calendarId);
    
    if (!calendar) {
      throw new Error(`Cannot access calendar: ${calendarId}`);
    }
    
    const event = calendar.getEventById(eventInfo.eventId);
    
    if (!event) {
      Logger.log(`âš ï¸ Event not found: ${eventInfo.eventId}`);
      return {
        success: false,
        error: 'Event not found',
        eventId: eventInfo.eventId
      };
    }
    
    // à¸­à¸±à¸›à¹€à¸”à¸•à¸Šà¸·à¹ˆà¸­ Event à¹‚à¸”à¸¢à¹€à¸à¸´à¹ˆà¸¡à¸ªà¸–à¸²à¸™à¸°
    const originalTitle = event.getTitle();
    let cleanTitle = originalTitle;
    
    // à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸¡à¸µà¸ªà¸–à¸²à¸™à¸°à¹€à¸à¹ˆà¸²à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ
    const statusPattern = /^\[(.*?)\]\s*/;
    const existingStatusMatch = cleanTitle.match(statusPattern);
    
    let newTitle;
    
    if (existingStatusMatch) {
      // à¸–à¹‰à¸²à¸¡à¸µà¸ªà¸–à¸²à¸™à¸°à¹€à¸à¹ˆà¸²à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§ â†’ à¹à¸—à¸™à¸—à¸µà¹ˆà¸ªà¸–à¸²à¸™à¸°à¹€à¸à¹ˆà¸²à¸”à¹‰à¸§à¸¢à¸ªà¸–à¸²à¸™à¸°à¹ƒà¸«à¸¡à¹ˆ
      cleanTitle = cleanTitle.replace(statusPattern, '').trim();
      newTitle = `[${status}] ${cleanTitle}`;
      Logger.log(`ğŸ”„ Replacing existing status: "${existingStatusMatch[1]}" â†’ "${status}"`);
    } else {
      // à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸–à¸²à¸™à¸° â†’ à¹€à¸à¸´à¹ˆà¸¡à¸ªà¸–à¸²à¸™à¸°à¹ƒà¸«à¸¡à¹ˆ
      newTitle = `[${status}] ${cleanTitle}`;
      Logger.log(`â• Adding new status: "${status}"`);
    }
    
    event.setTitle(newTitle);
    
    // à¸­à¸±à¸›à¹€à¸”à¸• Description
    const originalDescription = event.getDescription() || '';
    const statusTimestamp = new Date().toLocaleString('th-TH');
    
    let newDescription = originalDescription;
    
    // à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸–à¸²à¸™à¸°à¹€à¸à¹ˆà¸²à¸­à¸­à¸ (à¸–à¹‰à¸²à¸¡à¸µ)
    const statusSectionPattern = /\n\nâ”{40,}\n[âœ…ğŸ”„â¸ï¸âŒğŸ“…âœ”ï¸â›”].*?\nâ”{40,}[\s\S]*?â”{40,}/g;
    newDescription = newDescription.replace(statusSectionPattern, '');
    
    // à¹€à¸¥à¸·à¸­à¸ emoji à¸•à¸²à¸¡à¸ªà¸–à¸²à¸™à¸°
    const statusEmoji = getStatusEmoji(status);
    
    // à¹€à¸à¸´à¹ˆà¸¡à¸ªà¹ˆà¸§à¸™ Status Info à¹ƒà¸«à¸¡à¹ˆ
    const statusInfo = `\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
${statusEmoji} ${status.toUpperCase()}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“… Updated Date: ${statusTimestamp}
${statusNote ? `ğŸ“ Note: ${statusNote}` : ''}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`;
    
    newDescription += statusInfo;
    event.setDescription(newDescription);
    
    // à¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ªà¸µ Event (à¸•à¸²à¸¡à¸—à¸µà¹ˆ user à¸‚à¸­)
    // const color = getStatusColor(status);
    // if (color) {
    //   event.setColor(color);
    // }
    
    Logger.log(`âœ… Event updated successfully:`);
    Logger.log(`   Original: ${originalTitle}`);
    Logger.log(`   Updated:  ${newTitle}`);
    Logger.log(`   Status:   ${status}`);
    
    return {
      success: true,
      eventId: eventInfo.eventId,
      originalTitle: originalTitle,
      updatedTitle: newTitle,
      status: status,
      updateDate: statusTimestamp
    };
    
  } catch (error) {
    Logger.log(`âŒ Error updating event: ${error.toString()}`);
    return {
      success: false,
      error: error.toString(),
      eventId: eventInfo.eventId
    };
  }
}

// ====== HELPER: GET STATUS EMOJI ======

function getStatusEmoji(status) {
  const statusLower = status.toLowerCase();
  
  if (statusLower.includes('completed') || statusLower.includes('approved')) {
    return 'âœ…';
  } else if (statusLower.includes('progress')) {
    return 'ğŸ”„';
  } else if (statusLower.includes('pending')) {
    return 'â¸ï¸';
  } else if (statusLower.includes('hold')) {
    return 'â¸ï¸';
  } else if (statusLower.includes('cancelled') || statusLower.includes('rejected')) {
    return 'âŒ';
  } else if (statusLower.includes('rescheduled')) {
    return 'ğŸ“…';
  } else {
    return 'ğŸ“Š';
  }
}

// ====== HELPER: GET STATUS COLOR ======

function getStatusColor(status) {
  const statusLower = status.toLowerCase();
  
  // Google Calendar Color IDs:
  // 1=Lavender, 2=Sage, 3=Grape, 4=Flamingo, 5=Banana
  // 6=Tangerine, 7=Peacock, 8=Graphite, 9=Blueberry, 10=Basil, 11=Tomato
  
  if (statusLower.includes('completed') || statusLower.includes('approved')) {
    return CalendarApp.EventColor.GREEN; // à¸ªà¸µà¹€à¸‚à¸µà¸¢à¸§
  } else if (statusLower.includes('progress')) {
    return CalendarApp.EventColor.BLUE; // à¸ªà¸µà¸™à¹‰à¸³à¹€à¸‡à¸´à¸™
  } else if (statusLower.includes('pending')) {
    return CalendarApp.EventColor.YELLOW; // à¸ªà¸µà¹€à¸«à¸¥à¸·à¸­à¸‡
  } else if (statusLower.includes('hold')) {
    return CalendarApp.EventColor.ORANGE; // à¸ªà¸µà¸ªà¹‰à¸¡
  } else if (statusLower.includes('cancelled') || statusLower.includes('rejected')) {
    return CalendarApp.EventColor.RED; // à¸ªà¸µà¹à¸”à¸‡
  } else if (statusLower.includes('rescheduled')) {
    return CalendarApp.EventColor.PALE_BLUE; // à¸ªà¸µà¸Ÿà¹‰à¸²à¸­à¹ˆà¸­à¸™
  }
  
  return null; // à¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ªà¸µ
}

// ====== SEARCH CALENDAR EVENTS BY UNIQUE ID ======

function searchCalendarEventsByUniqueId(uniqueId, description, calendarId, searchDays = 60) {
  Logger.log(`ğŸ” Searching calendar "${calendarId}" for Unique ID: ${uniqueId}`);
  
  try {
    if (!calendarId || calendarId.trim() === '' || calendarId === 'your-calendar-id@group.calendar.google.com') {
      Logger.log('âŒ CALENDAR_ID is not configured!');
      Logger.log('ğŸ“ Please set CALENDAR_ID at the top of the script');
      return { 
        success: false, 
        message: 'CALENDAR_ID is not configured. Please set it in the script.', 
        events: [] 
      };
    }
    
    const calendar = CalendarApp.getCalendarById(calendarId);
    if (!calendar) {
      Logger.log(`âŒ Cannot access calendar: ${calendarId}`);
      throw new Error(`Cannot access calendar: ${calendarId}`);
    }

    const startDate = new Date();
    startDate.setDate(startDate.getDate() - searchDays);
    
    const endDate = new Date();
    endDate.setDate(endDate.getDate() + searchDays);
    
    const allEvents = calendar.getEvents(startDate, endDate);
    Logger.log(`ğŸ“Š Total events in range: ${allEvents.length}`);
    
    if (allEvents.length === 0) {
      return { success: false, message: 'No events found in date range', events: [] };
    }

    const matchingEvents = [];
    const cleanUniqueId = uniqueId.toLowerCase().trim();
    const cleanDescription = description ? description.toLowerCase().trim() : '';
    
    const uniqueIdSearchPatterns = [
      cleanUniqueId,
      `id: ${cleanUniqueId}`,
      `(${cleanUniqueId})`,
      `[${cleanUniqueId}]`,
      `id:${cleanUniqueId}`,
      `- ${cleanUniqueId}`,
      `${cleanUniqueId} -`,
    ];
    
    allEvents.forEach((event, index) => {
      try {
        const title = event.getTitle() || '';
        const eventDescription = event.getDescription() || '';
        const searchableText = (title + ' ' + eventDescription).toLowerCase();
        
        let uniqueIdMatch = false;
        let matchedPattern = '';
        
        for (const pattern of uniqueIdSearchPatterns) {
          if (searchableText.includes(pattern)) {
            uniqueIdMatch = true;
            matchedPattern = pattern;
            break;
          }
        }
        
        if (uniqueIdMatch) {
          if (cleanDescription && !searchableText.includes(cleanDescription)) {
            Logger.log(`âš ï¸ UniqueId match but description mismatch: "${title}"`);
          }
          
          Logger.log(`âœ… Found matching event: "${title}"`);
          Logger.log(`   Matched pattern: "${matchedPattern}"`);
          
          matchingEvents.push({
            event: event,
            eventId: event.getId(),
            title: title,
            description: eventDescription,
            startTime: event.getStartTime(),
            endTime: event.getEndTime(),
            location: event.getLocation() || '',
            created: event.getDateCreated(),
            lastUpdated: event.getLastUpdated()
          });
        }
        
      } catch (eventError) {
        Logger.log(`âš ï¸ Error processing event ${index + 1}: ${eventError.toString()}`);
      }
    });
    
    matchingEvents.sort((a, b) => b.created - a.created);
    
    if (matchingEvents.length === 0) {
      Logger.log(`âŒ No events found for uniqueId: ${uniqueId}`);
    }
    
    return {
      success: matchingEvents.length > 0,
      message: `Found ${matchingEvents.length} events for Unique ID: ${uniqueId}`,
      events: matchingEvents
    };
    
  } catch (error) {
    Logger.log(`âŒ Error searching calendar events: ${error.toString()}`);
    return { success: false, error: error.toString(), events: [] };
  }
}

// ====== WRAPPER: UPDATE TO COMPLETED (BACKWARD COMPATIBLE) ======

function updateSurveyToCompleted(
  uniqueId,
  description = '',
  completionNote = '',
  searchDays = 60
) {
  return updateSurveyStatus(
    uniqueId,
    STATUS_OPTIONS.COMPLETED,
    description,
    completionNote,
    searchDays
  );
}

// ====== TEST FUNCTIONS ======

function testUpdateStatus() {
  if (!CALENDAR_ID || CALENDAR_ID === 'your-calendar-id@group.calendar.google.com') {
    Logger.log('âŒ à¸à¸£à¸¸à¸“à¸²à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² CALENDAR_ID à¸à¹ˆà¸­à¸™à¹ƒà¸Šà¹‰à¸‡à¸²à¸™!');
    return;
  }
  
  // à¸—à¸”à¸ªà¸­à¸šà¸”à¹‰à¸§à¸¢à¸ªà¸–à¸²à¸™à¸°à¸•à¹ˆà¸²à¸‡à¹†
  const testCases = [
    { 
      uniqueId: "SW-0005", 
      status: STATUS_OPTIONS.COMPLETED,
      statusNote: "à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢à¹à¸¥à¹‰à¸§ à¹„à¸¡à¹ˆà¸à¸šà¸›à¸±à¸à¸«à¸²" 
    },
    { 
      uniqueId: "SW-0001", 
      status: STATUS_OPTIONS.IN_PROGRESS,
      statusNote: "à¸à¸³à¸¥à¸±à¸‡à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š" 
    },
    { 
      uniqueId: "SW-0003", 
      status: STATUS_OPTIONS.ON_HOLD,
      statusNote: "à¸£à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸à¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡à¸ˆà¸²à¸à¸¥à¸¹à¸à¸„à¹‰à¸²" 
    },
    { 
      uniqueId: "SW-0004", 
      status: "Custom Status: Ready for Review",
      statusNote: "à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸«à¹‰à¸«à¸±à¸§à¸«à¸™à¹‰à¸²à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š" 
    }
  ];
  
  testCases.forEach(test => {
    Logger.log(`\n${'='.repeat(50)}`);
    Logger.log(`Testing Update: ${test.uniqueId} â†’ ${test.status}`);
    Logger.log('='.repeat(50));
    
    const result = updateSurveyStatus(
      test.uniqueId,
      test.status,
      '',
      test.statusNote,
      60
    );
    
    Logger.log(`\nğŸ“Š Result:`);
    Logger.log(`   Success: ${result.success ? 'âœ… YES' : 'âŒ NO'}`);
    Logger.log(`   Status: ${result.status}`);
    Logger.log(`   Events Found: ${result.surveyEventsFound}`);
    Logger.log(`   Events Updated: ${result.surveyEventsUpdated}`);
    Logger.log(`   Message: ${result.message}`);
    
    if (result.updatedSurveyEvents.length > 0) {
      Logger.log(`\nğŸ“ Updated Events:`);
      result.updatedSurveyEvents.forEach((evt, idx) => {
        Logger.log(`   ${idx + 1}. ${evt.originalTitle}`);
        Logger.log(`      â†’ ${evt.updatedTitle}`);
      });
    }
  });
}

function testCalendarAccess() {
  Logger.log('ğŸ§ª Testing Calendar Access...\n');
  
  if (!CALENDAR_ID || CALENDAR_ID === 'your-calendar-id@group.calendar.google.com') {
    Logger.log('âŒ CALENDAR_ID is not configured!');
    
    Logger.log('ğŸ“‹ Available Calendars:');
    const calendars = CalendarApp.getAllCalendars();
    calendars.forEach((cal, index) => {
      Logger.log(`   ${index + 1}. ${cal.getName()}`);
      Logger.log(`      ID: ${cal.getId()}`);
    });
    return;
  }
  
  try {
    const calendar = CalendarApp.getCalendarById(CALENDAR_ID);
    
    if (calendar) {
      Logger.log(`âœ… Successfully connected to: ${calendar.getName()}`);
      Logger.log(`ğŸ“… Calendar ID: ${CALENDAR_ID}`);
      
      const now = new Date();
      const oneMonthAgo = new Date();
      oneMonthAgo.setDate(now.getDate() - 30);
      
      const events = calendar.getEvents(oneMonthAgo, now);
      Logger.log(`ğŸ“Š Events in last 30 days: ${events.length}`);
      
    } else {
      Logger.log('âŒ Cannot access calendar');
    }
    
  } catch (error) {
    Logger.log(`âŒ Error: ${error.toString()}`);
  }
}

// ====== DEMO: HOW TO USE ======

function demoUsage() {
  Logger.log('ğŸ“– à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™:\n');
  
  Logger.log('1. à¹ƒà¸Šà¹‰à¸ªà¸–à¸²à¸™à¸°à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”à¹„à¸§à¹‰:');
  Logger.log('   updateSurveyStatus("SW-0001", STATUS_OPTIONS.COMPLETED, "", "à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸ªà¸£à¹‡à¸ˆà¹à¸¥à¹‰à¸§");');
  Logger.log('   updateSurveyStatus("SW-0002", STATUS_OPTIONS.IN_PROGRESS, "", "à¸à¸³à¸¥à¸±à¸‡à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£");');
  Logger.log('   updateSurveyStatus("SW-0003", STATUS_OPTIONS.ON_HOLD, "", "à¸£à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥");\n');
  
  Logger.log('2. à¹ƒà¸Šà¹‰à¸ªà¸–à¸²à¸™à¸°à¹à¸šà¸šà¸à¸³à¸«à¸™à¸”à¹€à¸­à¸‡:');
  Logger.log('   updateSurveyStatus("SW-0004", "Waiting for Approval", "", "à¸£à¸­à¸à¸²à¸£à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´");');
  Logger.log('   updateSurveyStatus("SW-0005", "à¸ªà¹ˆà¸‡à¸¡à¸­à¸šà¸‡à¸²à¸™à¹à¸¥à¹‰à¸§", "", "à¸¥à¸¹à¸à¸„à¹‰à¸²à¸£à¸±à¸šà¸‡à¸²à¸™à¹à¸¥à¹‰à¸§");\n');
  
  Logger.log('3. à¹ƒà¸Šà¹‰à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹€à¸”à¸´à¸¡ (Backward Compatible):');
  Logger.log('   updateSurveyToCompleted("SW-0006", "", "à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ");\n');
  
  Logger.log('ğŸ“‹ à¸ªà¸–à¸²à¸™à¸°à¸—à¸µà¹ˆà¸¡à¸µà¹ƒà¸«à¹‰à¹€à¸¥à¸·à¸­à¸:');
  Object.keys(STATUS_OPTIONS).forEach(key => {
    Logger.log(`   - ${key}: "${STATUS_OPTIONS[key]}"`);
  });
}
