// ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏• (‡πÄ‡∏û‡∏¥‡πà‡∏° parameter ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£) =====
function sendRFIEmailFromAppSheet(params) {
  const { 
    email, 
    rfiNumber, 
    description, 
    status, 
    remarks, 
    requestDate,
    documentType = '',  // ‡πÄ‡∏û‡∏¥‡πà‡∏° parameter ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (Open RFI / Close RFI)
    surveyReport = '',  // ‡πÄ‡∏û‡∏¥‡πà‡∏° parameter ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
    surveyReportNumber = '',  // ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ Survey Report
    surveyReportRemarks = '',  // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ Survey Report
    labReport = '',
    labReportNumber = '',  // ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ LAB Report
    labReportRemarks = '',  // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ LAB Report
    qcReport = '',
    qcReportNumber = '',  // ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ QC Report
    qcReportRemarks = ''  // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ QC Report
  } = params;
  
  if (!email || !rfiNumber || !description || !status) {
    Logger.log("‚ùå Missing required field(s)");
    return false;
  }
  
  try {
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö quota
    const quota = checkEmailQuota();
    Logger.log(`üìä Current email quota: ${quota}`);
    
    if (quota <= 0) {
      Logger.log('‚ùå Email quota exceeded');
      return false;
    }
    
    let statusColor = getStatusColor(status);
    let statusIcon = getStatusIcon(status);
    const subject = `RFI #${rfiNumber} - ${description}`;
    
    Logger.log("=== RFI Email Info ===");
    Logger.log("üìß To: " + email);
    Logger.log("üî¢ RFI: " + rfiNumber);
    Logger.log("üìù Description: " + description);
    Logger.log("üìä Status: " + status);
    Logger.log("üìÅ Document Type: " + documentType);
    Logger.log("‚úâÔ∏è Subject: " + subject);
    
    const htmlMessage = createRFIEmailHTML(
      rfiNumber, 
      description, 
      status, 
      remarks, 
      requestDate, 
      statusColor, 
      statusIcon,
      documentType,
      surveyReport,
      surveyReportNumber,
      surveyReportRemarks,
      labReport,
      labReportNumber,
      labReportRemarks,
      qcReport,
      qcReportNumber,
      qcReportRemarks
    );
    
    // ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏ö‡∏ö batch
    const sent = safeSendEmail({
      to: email,
      subject: subject,
      htmlBody: htmlMessage,
      name: 'RFI System - Notification'
    });
    
    if (!sent) {
      Logger.log('‚ùå Failed to send email');
      return false;
    }
    
    Logger.log("=====================");
    Logger.log(`‚úÖ RFI Email sent successfully to: ${email}`);
    return true;
    
  } catch (error) {
    Logger.log(`‚ùå Error: ${error.toString()}`);
    return false;
  }
}

// ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô (‡πÄ‡∏û‡∏¥‡πà‡∏° parameter ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£) =====
function sendRFIEmailToMultipleRecipients(emailList, rfiNumber, description, status, remarks, requestDate, documentType = '', surveyReport = '', surveyReportNumber = '', surveyReportRemarks = '', labReport = '', labReportNumber = '', labReportRemarks = '', qcReport = '', qcReportNumber = '', qcReportRemarks = '') {
  let emails = [];
  
  if (typeof emailList === 'string') {
    emails = emailList.split(/[,;]/).map(e => e.trim()).filter(e => e.length > 0 && e.includes('@'));
  } else if (Array.isArray(emailList)) {
    emails = emailList.filter(e => e && e.includes('@'));
  } else {
    Logger.log("‚ùå Invalid email format");
    return false;
  }
  
  if (emails.length === 0) {
    Logger.log("‚ùå No valid email addresses found");
    return false;
  }
  
  try {
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö quota
    const quota = checkEmailQuota();
    Logger.log(`üìä Current email quota: ${quota}`);
    
    if (quota <= 0) {
      Logger.log('‚ùå Email quota exceeded');
      return false;
    }
    
    Logger.log(`üìß Sending batch email to ${emails.length} recipient(s): ${emails.join(', ')}`);
    
    const statusColor = getStatusColor(status);
    const statusIcon = getStatusIcon(status);
    const subject = `RFI #${rfiNumber} - ${description}`;
    const htmlMessage = createRFIEmailHTML(
      rfiNumber, 
      description, 
      status, 
      remarks, 
      requestDate, 
      statusColor, 
      statusIcon,
      documentType,
      surveyReport,
      surveyReportNumber,
      surveyReportRemarks,
      labReport,
      labReportNumber,
      labReportRemarks,
      qcReport,
      qcReportNumber,
      qcReportRemarks
    );
    
    // ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö batch (‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
    const recipientList = emails.join(',');
    
    const sent = safeSendEmail({
      to: recipientList,
      subject: subject,
      htmlBody: htmlMessage,
      name: 'RFI System - Notification'
    });
    
    if (!sent) {
      Logger.log('‚ùå Failed to send batch email');
      return { success: 0, failed: emails.length };
    }
    
    Logger.log(`‚úÖ Batch email sent successfully to ${emails.length} recipients`);
    Logger.log(`üìä Email quota used: 1 (saved ${emails.length - 1} quota)`);
    
    return { success: emails.length, failed: 0 };
    
  } catch (error) {
    Logger.log(`‚ùå Error: ${error.toString()}`);
    return { success: 0, failed: emails.length };
  }
}

// ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ =====
function getDocumentStatusIcon(status) {
  if (!status) return '';
  
  const statusLower = status.toLowerCase().trim();
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Approve
  if (statusLower.includes('approve')) {
    return '‚úÖ';
  }
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Reject
  if (statusLower.includes('reject')) {
    return '‚ùå';
  }
  
  return 'üìÑ';
}

function getDocumentStatusColor(status) {
  if (!status) return '';
  
  const statusLower = status.toLowerCase().trim();
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Approve
  if (statusLower.includes('approve')) {
    return '#2ed573';
  }
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Reject
  if (statusLower.includes('reject')) {
    return '#ff4757';
  }
  
  return '#57606f';
}

function hasAnyDocumentStatus(surveyReport, labReport, qcReport) {
  return (surveyReport && surveyReport.trim() !== '') || 
         (labReport && labReport.trim() !== '') || 
         (qcReport && qcReport.trim() !== '');
}

// ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Status ‡πÅ‡∏•‡∏∞ Icon (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) =====
function getStatusColor(status) {
  const statusLower = status.toLowerCase();
  
  if (statusLower.includes('open rfi pending attachment')) return '#FF6B6B';
  if (statusLower.includes('pending qc review') || 
      statusLower.includes('revised attachment submitted ‚Äì pending qc review')) return '#FF9F43';
  if (statusLower.includes('pending survey review')) return '#FFA726';
  if (statusLower.includes('ready for consult review') ||
      statusLower.includes('qc approved ‚Äì waiting for consult review')) return '#3742fa';
  if (statusLower.includes('rfi approved ‚Äì proceed to site inspection')) return '#2ed573';
  if (statusLower.includes('awaiting final documents for rfi closure') ||
      statusLower.includes('consult approved ‚Äì awaiting signed documents')) return '#5352ed';
  if (statusLower.includes('waiting for revised attachment')) return '#ffa502';
  if (statusLower.includes('rejected by consult ‚Äì revise required') ||
      statusLower.includes('rejected by survey reviewer')) return '#ff4757';
  if (statusLower.includes('rfi closure documents attached')) return '#1dd1a1';
  if (statusLower.includes('inspection started')) return '#00d2d3';
  if (statusLower.includes('inspection postponed')) return '#ff9ff3';
  if (statusLower.includes('site inspection completed by inspector')) return '#7bed9f';
  if (statusLower.includes('cancel')) return '#747d8c';
  
  return '#57606f';
}

function getStatusIcon(status) {
  const statusLower = status.toLowerCase();
  
  if (statusLower.includes('open rfi pending attachment')) return 'üìã';
  if (statusLower.includes('pending qc review') || 
      statusLower.includes('revised attachment submitted ‚Äì pending qc review')) return 'üîç';
  if (statusLower.includes('pending survey review')) return 'üîé';
  if (statusLower.includes('ready for consult review') ||
      statusLower.includes('qc approved ‚Äì waiting for consult review')) return 'üë®‚Äçüíº';
  if (statusLower.includes('rfi approved ‚Äì proceed to site inspection')) return '‚úÖ';
  if (statusLower.includes('awaiting final documents for rfi closure') ||
      statusLower.includes('consult approved ‚Äì awaiting signed documents')) return 'üìù';
  if (statusLower.includes('waiting for revised attachment')) return 'üîÑ';
  if (statusLower.includes('rejected by consult ‚Äì revise required') ||
      statusLower.includes('rejected by survey reviewer')) return '‚ùå';
  if (statusLower.includes('rfi closure documents attached')) return 'üéâ';
  if (statusLower.includes('inspection started')) return 'üîç';
  if (statusLower.includes('inspection postponed')) return '‚è∞';
  if (statusLower.includes('site inspection completed by inspector')) return '‚úÖ';
  if (statusLower.includes('cancel')) return 'üö´';
  
  return 'üìÑ';
}

// ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á HTML (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£) =====
function createRFIEmailHTML(rfiNumber, description, status, remarks, requestDate, statusColor, statusIcon, documentType, surveyReport, surveyReportNumber, surveyReportRemarks, labReport, labReportNumber, labReportRemarks, qcReport, qcReportNumber, qcReportRemarks) {
  const currentDate = new Date().toLocaleDateString('th-TH', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  });
  
  let formattedRequestDate = '';
  if (requestDate) {
    try {
      const reqDate = new Date(requestDate);
      formattedRequestDate = reqDate.toLocaleDateString('th-TH', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
    } catch (error) {
      formattedRequestDate = requestDate;
    }
  }
  
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
  let documentTypeHTML = '';
  if (documentType && documentType.trim() !== '') {
    const typeColor = documentType.toLowerCase().includes('close') ? '#2ed573' : '#3742fa';
    const typeIcon = documentType.toLowerCase().includes('close') ? 'üìÅ' : 'üìÇ';
    documentTypeHTML = `
      <div style="text-align: center; margin-bottom: 15px;">
        <span style="display: inline-block; background-color: ${typeColor}; color: white; padding: 8px 20px; border-radius: 20px; font-size: 14px; font-weight: bold;">
          ${typeIcon} ${documentType}
        </span>
      </div>
    `;
  }
  
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
  const hasDocStatus = hasAnyDocumentStatus(surveyReport, labReport, qcReport);
  
  let documentStatusHTML = '';
  if (hasDocStatus) {
    documentStatusHTML = '<div class="document-status-section">';
    documentStatusHTML += '<h3 style="color: #333; margin-bottom: 15px; font-size: 18px;">üìë ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h3>';
    documentStatusHTML += '<div class="document-status-grid">';
    
    // Survey Report
    if (surveyReport && surveyReport.trim() !== '') {
      const surveyIcon = getDocumentStatusIcon(surveyReport);
      const surveyColor = getDocumentStatusColor(surveyReport);
      documentStatusHTML += `
        <div class="doc-status-item" style="border-left-color: ${surveyColor};">
          <div class="doc-label">üìä Survey Report</div>
          ${surveyReportNumber && surveyReportNumber.trim() !== '' ? `
          <div class="doc-number">
            üìã ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà: ${surveyReportNumber}
          </div>
          ` : ''}
          <div class="doc-status" style="background-color: ${surveyColor};">
            ${surveyIcon} ${surveyReport}
          </div>
          ${surveyReportRemarks && surveyReportRemarks.trim() !== '' ? `
          <div class="doc-remarks">
            üí¨ ${surveyReportRemarks}
          </div>
          ` : ''}
        </div>
      `;
    }
    
    // LAB Report
    if (labReport && labReport.trim() !== '') {
      const labIcon = getDocumentStatusIcon(labReport);
      const labColor = getDocumentStatusColor(labReport);
      documentStatusHTML += `
        <div class="doc-status-item" style="border-left-color: ${labColor};">
          <div class="doc-label">üß™ LAB Report</div>
          ${labReportNumber && labReportNumber.trim() !== '' ? `
          <div class="doc-number">
            üìã ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà: ${labReportNumber}
          </div>
          ` : ''}
          <div class="doc-status" style="background-color: ${labColor};">
            ${labIcon} ${labReport}
          </div>
          ${labReportRemarks && labReportRemarks.trim() !== '' ? `
          <div class="doc-remarks">
            üí¨ ${labReportRemarks}
          </div>
          ` : ''}
        </div>
      `;
    }
    
    // QC Report
    if (qcReport && qcReport.trim() !== '') {
      const qcIcon = getDocumentStatusIcon(qcReport);
      const qcColor = getDocumentStatusColor(qcReport);
      documentStatusHTML += `
        <div class="doc-status-item" style="border-left-color: ${qcColor};">
          <div class="doc-label">‚úîÔ∏è QC Report</div>
          ${qcReportNumber && qcReportNumber.trim() !== '' ? `
          <div class="doc-number">
            üìã ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà: ${qcReportNumber}
          </div>
          ` : ''}
          <div class="doc-status" style="background-color: ${qcColor};">
            ${qcIcon} ${qcReport}
          </div>
          ${qcReportRemarks && qcReportRemarks.trim() !== '' ? `
          <div class="doc-remarks">
            üí¨ ${qcReportRemarks}
          </div>
          ` : ''}
        </div>
      `;
    }
    
    documentStatusHTML += '</div></div>';
  }
  
  return `
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <style>
        body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          line-height: 1.6;
          margin: 0;
          padding: 20px;
          background-color: #f4f4f4;
        }
        .email-container {
          max-width: 600px;
          margin: 0 auto;
          background-color: white;
          border-radius: 10px;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          overflow: hidden;
        }
        .header {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          padding: 30px 20px;
          text-align: center;
        }
        .header h1 {
          margin: 0;
          font-size: 28px;
          font-weight: 300;
        }
        .content {
          padding: 30px;
        }
        .rfi-card {
          background-color: #f8f9ff;
          border-left: 5px solid ${statusColor};
          padding: 20px;
          margin: 20px 0;
          border-radius: 5px;
        }
        .rfi-number {
          font-size: 24px;
          font-weight: bold;
          color: #333;
          margin-bottom: 10px;
        }
        .status-badge {
          display: inline-block;
          background-color: ${statusColor};
          color: white;
          padding: 8px 16px;
          border-radius: 20px;
          font-size: 14px;
          font-weight: bold;
          margin: 10px 0;
        }
        .info-row {
          margin: 15px 0;
          padding: 10px 0;
          border-bottom: 1px solid #eee;
        }
        .info-row:last-child {
          border-bottom: none;
        }
        .label {
          font-weight: bold;
          color: #555;
          display: inline-block;
          width: 120px;
        }
        .value {
          color: #333;
        }
        .description {
          background-color: white;
          padding: 15px;
          border-radius: 5px;
          border: 1px solid #ddd;
          margin-top: 10px;
        }
        .remarks {
          background-color: #fff3cd;
          border: 1px solid #ffeaa7;
          padding: 15px;
          border-radius: 5px;
          margin-top: 10px;
        }
        .document-status-section {
          margin-top: 25px;
          padding-top: 20px;
          border-top: 2px solid #e0e0e0;
        }
        .document-status-grid {
          display: grid;
          gap: 15px;
          margin-top: 15px;
        }
        .doc-status-item {
          background-color: #f8f9fa;
          padding: 15px;
          border-radius: 8px;
          border-left: 4px solid #ccc;
          transition: transform 0.2s;
        }
        .doc-label {
          font-weight: bold;
          color: #555;
          font-size: 14px;
          margin-bottom: 8px;
        }
        .doc-number {
          font-size: 13px;
          color: #666;
          margin-bottom: 8px;
          padding: 5px 10px;
          background-color: #e8f4f8;
          border-radius: 4px;
          display: inline-block;
        }
        .doc-status {
          display: inline-block;
          color: white;
          padding: 6px 12px;
          border-radius: 15px;
          font-size: 13px;
          font-weight: bold;
        }
        .doc-remarks {
          margin-top: 10px;
          padding: 10px;
          background-color: #fff3cd;
          border: 1px solid #ffeaa7;
          border-radius: 5px;
          font-size: 13px;
          color: #333;
          line-height: 1.5;
        }
        .footer {
          background-color: #f8f9fa;
          padding: 20px;
          text-align: center;
          color: #666;
          font-size: 12px;
        }
        .divider {
          height: 2px;
          background: linear-gradient(90deg, transparent, ${statusColor}, transparent);
          margin: 20px 0;
        }
      </style>
    </head>
    <body>
      <div class="email-container">
        <div class="header">
          <h1>üìã RFI Notification</h1>
          <p style="margin: 5px 0 0 0; opacity: 0.9;">Request for Information</p>
        </div>
        
        <div class="content">
          <div class="rfi-card">
            <div class="rfi-number">
              ${statusIcon} RFI #${rfiNumber}
            </div>
            
            ${documentTypeHTML}
            
            <div class="status-badge">
              Status: ${status}
            </div>
            
            <div class="divider"></div>
            
            <div class="info-row">
              <span class="label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</span>
              <div class="description">
                ${description}
              </div>
            </div>
            
            ${remarks ? `
            <div class="info-row">
              <span class="label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</span>
              <div class="remarks">
                <strong>üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong><br>
                ${remarks}
              </div>
            </div>
            ` : ''}
            
            ${requestDate ? `
            <div class="info-row">
              <span class="label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:</span>
              <span class="value">üìÖ ${formattedRequestDate}</span>
            </div>
            ` : ''}
            
            <div class="info-row">
              <span class="label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á:</span>
              <span class="value">${currentDate}</span>
            </div>
            
            ${documentStatusHTML}
          </div>
          
          <p style="text-align: center; color: #666; margin-top: 30px;">
            üí° <em>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° RFI ‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</em>
          </p>
        </div>
        
        <div class="footer">
          <p>üè¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ RFI | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ AppSheet</p>
          <p>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ</p>
        </div>
      </div>
    </body>
    </html>
  `;
}

// ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Helper =====
function checkEmailQuota() {
  try {
    const remainingQuota = MailApp.getRemainingDailyQuota();
    Logger.log('Remaining email quota:', remainingQuota);
    return remainingQuota;
  } catch (error) {
    Logger.log('Error checking email quota:', error);
    return 0;
  }
}

function safeSendEmail(emailParams) {
  try {
    const quota = checkEmailQuota();
    if (quota <= 0) {
      Logger.log('Email quota exceeded, skipping email');
      return false;
    }
    
    MailApp.sendEmail(emailParams);
    return true;
  } catch (error) {
    Logger.log('Error sending email:', error);
    return false;
  }
}

// ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö =====

// 1. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß + ‡∏°‡∏µ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö
function testSingleEmail() {
  sendRFIEmailFromAppSheet({
    email: "surveymarine048@gmail.com",
    rfiNumber: "10-RFI-001",
    description: "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö RFI - Batch Email ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£",
    status: "Open RFI Pending Attachment",
    remarks: "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö batch ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£",
    requestDate: "2024-10-15",
    documentType: "Open RFI",
    surveyReport: "Approved",
    surveyReportNumber: "SUR-2024-001",
    surveyReportRemarks: "‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß",
    labReport: "Rejected",
    labReportNumber: "LAB-2024-055",
    labReportRemarks: "‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ 3 ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3 ‡∏ß‡∏±‡∏ô",
    qcReport: "Approved",
    qcReportNumber: "QC-2024-012",
    qcReportRemarks: ""  // ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ - ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á
  });
}

// 2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô + ‡∏°‡∏µ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô
function testMultipleEmails() {
  sendRFIEmailToMultipleRecipients(
    "surveymarine048@gmail.com, surveymarine049@gmail.com",
    "10-RFI-003",
    "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£",
    "Inspection Started",
    "‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô - ‡πÉ‡∏ä‡πâ quota ‡πÅ‡∏Ñ‡πà 1",
    "2024-10-15",
    "Close RFI",
    "Approved",
    "SUR-2024-003",
    "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡πâ‡∏ß",
    "",
    "",
    "",
    "Rejected",
    "",
    "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà"
  );
}

// 3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏•‡∏¢
function testNoDocumentStatus() {
  sendRFIEmailFromAppSheet({
    email: "surveymarine048@gmail.com",
    rfiNumber: "10-RFI-002",
    description: "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£",
    status: "Pending QC Review",
    remarks: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ - ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ",
    requestDate: "2024-10-15",
    documentType: "Open RFI"
    // ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà surveyReport, labReport, qcReport
  });
}

// 4. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Open RFI ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
function testOpenRFI() {
  sendRFIEmailFromAppSheet({
    email: "surveymarine048@gmail.com",
    rfiNumber: "10-RFI-004",
    description: "‡∏ó‡∏î‡∏™‡∏≠‡∏ö Open RFI ‡πÅ‡∏ö‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå",
    status: "Ready for Consult Review",
    remarks: "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö",
    requestDate: "2024-10-15",
    documentType: "Open RFI",
    surveyReport: "Approved",
    surveyReportNumber: "SUR-2024-004",
    surveyReportRemarks: "Survey Report ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏≤‡∏Å Surveyor ‡πÅ‡∏•‡πâ‡∏ß",
    labReport: "Approved",
    labReportNumber: "LAB-2024-088",
    labReportRemarks: "‡∏ú‡∏•‡πÅ‡∏•‡πâ‡∏ö‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡πà‡∏á‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥",
    qcReport: "Approved",
    qcReportNumber: "QC-2024-025",
    qcReportRemarks: "QC ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ"
  });
}

// 5. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Close RFI ‡∏û‡∏£‡πâ‡∏≠‡∏° Reject documents
function testCloseRFI() {
  sendRFIEmailFromAppSheet({
    email: "surveymarine048@gmail.com",
    rfiNumber: "10-RFI-005",
    description: "‡∏ó‡∏î‡∏™‡∏≠‡∏ö Close RFI ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å Reject",
    status: "Awaiting Final Documents for RFI Closure",
    remarks: "‡∏£‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏¥‡∏î RFI ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥",
    requestDate: "2024-10-15",
    documentType: "Close RFI",
    surveyReport: "Rejected",
    surveyReportNumber: "SUR-2024-005",
    surveyReportRemarks: "Survey Report ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Section 2.3 ‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ö‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°",
    labReport: "Approved",
    labReportNumber: "LAB-2024-099",
    labReportRemarks: "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏à‡∏≤‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå",
    qcReport: "Rejected",
    qcReportNumber: "QC-2024-030",
    qcReportRemarks: "‡∏û‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 5, 7 ‡πÅ‡∏•‡∏∞ 12 ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 5 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£"
  });
}

// 6. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ Document Type
function testMultipleEmailsNoType() {
  sendRFIEmailToMultipleRecipients(
    "surveymarine048@gmail.com, surveymarine049@gmail.com, test@example.com",
    "10-RFI-006",
    "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£",
    "Pending Survey Review",
    "‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏° Survey ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",
    "2024-10-15",
    "",  // ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏ Document Type
    "Approved",
    "",
    "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢",
    "",
    "",
    "",
    "",
    "",
    ""
  );
}

// 7. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏£‡∏ì‡∏µ Inspection Started
function testInspectionStarted() {
  sendRFIEmailFromAppSheet({
    email: "surveymarine048@gmail.com",
    rfiNumber: "10-RFI-007",
    description: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏ô‡∏™‡∏ô‡∏≤‡∏°",
    status: "Inspection Started",
    remarks: "Inspector ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤ 09:00 ‡∏ô.",
    requestDate: "2024-10-15",
    documentType: "Open RFI",
    surveyReport: "Approved",
    surveyReportNumber: "SUR-2024-007",
    surveyReportRemarks: "",
    labReport: "Approved",
    labReportNumber: "LAB-2024-100",
    labReportRemarks: "",
    qcReport: "Approved",
    qcReportNumber: "QC-2024-040",
    qcReportRemarks: ""
  });
}

// 8. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏£‡∏ì‡∏µ RFI Cancelled
function testCancelledRFI() {
  sendRFIEmailFromAppSheet({
    email: "surveymarine048@gmail.com",
    rfiNumber: "10-RFI-008",
    description: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å RFI ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô",
    status: "Cancel",
    remarks: "‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô RFI ‡∏ô‡∏µ‡πâ‡∏à‡∏∂‡∏á‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å",
    requestDate: "2024-10-15",
    documentType: "Open RFI",
    surveyReport: "",
    surveyReportNumber: "",
    surveyReportRemarks: "",
    labReport: "",
    labReportNumber: "",
    labReportRemarks: "",
    qcReport: "",
    qcReportNumber: "",
    qcReportRemarks: ""
  });
}

// 9. ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Status ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö
function showAllRFIStatuses() {
  const statuses = [
    "Open RFI Pending Attachment",
    "Pending QC Review",
    "Pending Survey Review", 
    "Ready for Consult Review",
    "QC Approved ‚Äì Waiting for Consult Review",
    "RFI Approved ‚Äì Proceed to Site Inspection",
    "Awaiting Final Documents for RFI Closure",
    "Consult Approved ‚Äì Awaiting Signed Documents",
    "Waiting for Revised Attachment",
    "Revised Attachment Submitted ‚Äì Pending QC Review",
    "Rejected by Consult ‚Äì Revise Required",
    "Rejected by Survey Reviewer",
    "RFI Closure Documents Attached",
    "Inspection Started",
    "Inspection Postponed", 
    "Site Inspection Completed by Inspector",
    "Cancel"
  ];
  
  Logger.log("=".repeat(60));
  Logger.log("üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Status ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô");
  Logger.log("=".repeat(60));
  
  statuses.forEach((status, index) => {
    const color = getStatusColor(status);
    const icon = getStatusIcon(status);
    Logger.log(`${index + 1}. ${icon} ${status}`);
    Logger.log(`   Color: ${color}`);
    Logger.log("");
  });
  
  Logger.log("=".repeat(60));
}

// 10. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô (‡∏£‡∏∞‡∏ß‡∏±‡∏á quota!)
function testAllFunctions() {
  Logger.log("üß™ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô...");
  Logger.log("‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏ä‡πâ Email Quota ‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏±‡∏ô!");
  Logger.log("");
  
  const quota = checkEmailQuota();
  Logger.log(`üìä Email Quota ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${quota}`);
  
  if (quota < 10) {
    Logger.log("‚ùå Email Quota ‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠! ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 10 quota");
    return;
  }
  
  Logger.log("");
  Logger.log("1Ô∏è‚É£ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß...");
  testSingleEmail();
  Utilities.sleep(2000);
  
  Logger.log("");
  Logger.log("2Ô∏è‚É£ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô...");
  testMultipleEmails();
  Utilities.sleep(2000);
  
  Logger.log("");
  Logger.log("3Ô∏è‚É£ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£...");
  testNoDocumentStatus();
  Utilities.sleep(2000);
  
  Logger.log("");
  Logger.log("4Ô∏è‚É£ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Open RFI...");
  testOpenRFI();
  Utilities.sleep(2000);
  
  Logger.log("");
  Logger.log("5Ô∏è‚É£ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Close RFI...");
  testCloseRFI();
  
  Logger.log("");
  Logger.log("‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!");
  Logger.log(`üìä Email Quota ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${checkEmailQuota()}`);
}
